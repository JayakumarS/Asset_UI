<section class="content">
    <div class="content-block">
      <div class="block-header" style="padding: 0.5% !important;">
        <!-- breadcrumb -->
        <app-breadcrumb [title]="'Asset History Report'" [items]="['Reports']" [active_item]="'Asset History Report List'">
        </app-breadcrumb>
      </div>
      <div class="row clearfix" >
        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
        <div class="box-shadow">
          <div class="card">
            <div class="body" style="padding-left: 1%;">
              <form class="m-4" [formGroup]="docForm">
                <h5 style="color: rgb(10, 25, 109);">Required Filters to Search</h5><br>
                <div class="row" style="padding-left: 10%;">
                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">BRANCH</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 ">
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <mat-select formControlName="branch">
                                <mat-option *ngFor="let title of branchList" [value]="title.id">
                                  {{title.text}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">CATEGORY</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <mat-select tabindex="6" formControlName="category" >
                                <mat-option *ngFor="let title of categoryList" [value]="title.id">
                                    {{title.text}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">ASSET NAME</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <mat-select formControlName="assetName">
                                <mat-option *ngFor="let title of assetListDashboard" [value]="title.id">
                                  {{title.text}}
                                </mat-option>
                              </mat-select>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row" style="padding-left: 10%;">
                  <div class=" col-md-1">
                      <label style="margin-top: 11px;">LOCATION</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 ">
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <mat-select tabindex="5" formControlName="location">
                                <mat-option *ngFor="let title of locationDdList" [value]="title.id">
                                    {{title.text}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">DEPARTMENT</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <mat-select tabindex="26" formControlName="department">
                                <mat-option *ngFor="let title of departmentDdList"
                                    [value]="title.id">
                                    {{title.text}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">PUT IN USE</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                            <input matInput [matDatepicker]="picker2" tabindex="27"
                                formControlName="putInUseobj"
                                (dateInput)="$event.value.format('DD/MM/YYYY')"
                                id="putInUse"
                                (dateChange)="getDateString($event, 'putInUse',0)">
                            <mat-datepicker-toggle matSuffix
                                [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row" style="padding-left: 10%;">
                  <div class=" col-md-1">
                      <label style="margin-top: 11px;">BRAND</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 ">
                      <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                        <mat-select tabindex="5" formControlName="brandId">
                          <mat-option *ngFor="let title of brandDdList" [value]="title.id">
                              {{title.text}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">ITEM</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                      <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                        <mat-select tabindex="26" formControlName="item">
                            <mat-option *ngFor="let title of itemCodeNameList"
                            [value]="title.id">
                            {{title.text}}
                            </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>

                    <div class=" col-md-1">
                        <label style="margin-top: 11px;">STATUS</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                      <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                        <mat-select tabindex="5"  formControlName="statusId">
                          <mat-option *ngFor="let title of statusDdList" [value]="title.id">
                              {{title.text}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                    </div>
                </div>

                <div class="row" style="padding-left: 10%;">
                  <div class=" col-md-1">
                      <label style="margin-top: 11px;">VENDOR</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 ">
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                        <mat-select tabindex="15" formControlName="vendor">
                            <mat-option *ngFor="let title of uomList"
                                [value]="title.text">
                                {{title.text}}
                            </mat-option>
                        </mat-select>
                        </mat-form-field>
                    </div>

                    <div class=" col-md-1">
                    <label style="margin-top: 11px;">ASSET OWNER</label>
                    </div>
                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                        <mat-select tabindex="26" formControlName="assetOwner">
                            <mat-option *ngFor="let title of assetUserList"
                                [value]="title.text">
                                {{title.text}}
                            </mat-option>
                        </mat-select>
                        </mat-form-field>
                    </div>

                    <div class=" col-md-2">
                      <label style="margin-top: 11px;">IS AUDITABLE</label>
                    </div>
                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                      <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                        <mat-checkbox style="margin-top: 8px;margin-left: -99px;" formControlName="isAuditable" ngInit="checked=true"></mat-checkbox>
                      </div>
                    </div>
                </div>

                <div class="row" style="padding-left: 10%;">
                  <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 " style="padding-top: 15px;">
                    <mat-radio-group formControlName="financialYear" >
                      <mat-radio-button value="2023">CURRENT FY</mat-radio-button>
                      <mat-radio-button style="margin-left: 80px;" value="2022">PREVIOUS FY</mat-radio-button>
                    </mat-radio-group>
                </div>
                </div><br>

                <div class="row" >
                  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                    <button (click) = "onSubmit()" class="btn-space" mat-raised-button
                      color="accent" style="margin-left: 43%;background-color: #34d034;">Submit</button>
                    <button color="primary" type="button" class="btn-space" (click)="reset()" mat-raised-button>Reset</button>
                  </div>
                </div>

                <hr><br>
                <h5 style="color: rgb(10, 25, 109);">Required Columns in Excel Export <span style="color: red;">*</span></h5><br>
                <div class="row">
                  <div class=" col-md-2">
                      <label style="margin-top: 9px;">ASSET NAME</label>
                    </div>
                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                      <mat-checkbox style="margin-top: 6px;margin-left: -50px; " formControlName="assetNameCheckBox"
                       ngInit="checked=true"></mat-checkbox>
                    </div>
                    <div class=" col-md-2">
                        <label style="margin-top: 9px;">ASSET CODE</label>
                    </div>
                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="assetCodeCheckBox" 
                       ngInit="checked=true"></mat-checkbox>
                    </div>
                    <div class=" col-md-2">
                      <label style="margin-top: 9px;">ASSET LOCATION</label>
                    </div>
                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="assetLocationCheckBox" ngInit="checked=true"></mat-checkbox>
                    </div>
                    <div class=" col-md-2">
                        <label style="margin-top: 9px;">ASSET CATEGORY</label>
                    </div>
                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="assetCategoryCheckBox" ngInit="checked=true"></mat-checkbox>
                    </div>
                </div><br>

                <div class="row">
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">STATUS</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="statusCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">BRAND</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="brandCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <!-- <div class=" col-md-2">
                    <label style="margin-top: 9px;">MODEL</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="modelCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div> -->
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">PURCHASE PRICE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="purchasePriceCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>

                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">CAPTITALIZATION PRICE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="captitalizationPriceCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                </div>
                <br>
              
                <div class="row">
                  
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">END LIFE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="endLifeCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">PUT IN USE DATE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="putInUseDateCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">ASSET USER</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="assetUserCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div> 

                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">TOTAL HOURS USAGE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="totalHoursUsageCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>

                </div><br>

                <div class="row">
                  
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">DEPARTMENT</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="departmentCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">INVOICE NO</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="invoiceNoCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">INVOICE DATE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="invoiceDateCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div> 

                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">CAPTITALIZATION DATE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="capitalizationDateCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>

                </div><br>

                <div class="row">
                  
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">BUSINESS AREA</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="businessAreaCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">VENDOR</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="vendorCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>
                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">COST-TOTAL COST</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="costCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div> 

                  <div class=" col-md-2">
                    <label style="margin-top: 9px;">SAPCODE</label>
                  </div>
                  <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                    <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="sapCodeCheckBox" ngInit="checked=true"></mat-checkbox>
                  </div>

                </div><br>

               
                <hr>
                <br>
                
                <div class="row">
                  <div class=" col-md-6">
                      <h5 style="color: rgb(10, 25, 109);">Filters based Asset History List</h5>
                  </div>
                  <div class=" col-md-6">
                    <div class="export-button m-l-10" matTooltip="Export To Excel" style="margin-left: 77%;">
                      <button color="primary" type="button" class="btn-space" (click)="exportExcel()" 
                      *ngIf="docForm.get('assetNameCheckBox')?.value || docForm.get('assetCodeCheckBox')?.value || 
                      docForm.get('assetCategoryCheckBox')?.value || docForm.get('assetLocationCheckBox')?.value || 
                      docForm.get('assetUserCheckBox')?.value || docForm.get('captitalizationPriceCheckBox')?.value || 
                      docForm.get('modelCheckBox')?.value || docForm.get('putInUseDateCheckBox')?.value || 
                      docForm.get('brandCheckBox')?.value || docForm.get('statusCheckBox')?.value || 
                      docForm.get('endLifeCheckBox')?.value || docForm.get('purchasePriceCheckBox')?.value 
                      || docForm.get('totalHoursUsageCheckBox')?.value"
                      mat-raised-button>Export To Excel</button>
                    </div>
                  </div>
                </div><br>
                
                <div class="tableBody">
                    <div class="table-responsive">
                      <table class="table table-hover table-striped" style="width: 130%;">
                        <thead>
                          <tr>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Asset Name</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Asset Id</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Location</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Category Name</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Status</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Brand</th>
                            <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">Purchase Price</th>
                            <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">Captitalization Price</th>
                            <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">End Life</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Put Use Date</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Asset User</th>
                            <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">Total Hours Usage</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let data of assetHistoryList | paginate: { itemsPerPage: 5, currentPage: pageChanged }">
                            <td>{{data.assetName}}</td>
                            <td>{{data.assetId}}</td>
                            <td>{{data.location}}</td>
                            <td>{{data.categoryName}}</td>
                            <td>{{data.status}}</td>
                            <td>{{data.brand}}</td>
                            <td>{{data.purchasePrice}}</td>
                            <td>{{data.captitalizationPrice}}</td>
                            <td>{{data.endLife}}</td>
                            <td>{{data.putUseDate}}</td>
                            <td>{{data.assetUser}}</td>
                            <td>{{data.totalHoursUsage}}</td>
                          </tr>
                        </tbody>
                      </table>
                      <div style="margin-left: 40%;">
                        <pagination-controls (pageChange)="pageChanged=($event)"></pagination-controls>
                      </div>
                    </div>
                  </div>
              </form>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </section>


