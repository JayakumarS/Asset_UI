<section class="content">
    <div class="content-block">
        <div class="block-header" style="padding: 0.5% !important;">
            <app-breadcrumb [title]="'Loan-Report'" [items]="['Reports']" [active_item]="'Loan-Report List'">
            </app-breadcrumb>
        </div>
        <div class="row clearfix" >
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                <div class="box-shadow">
                    <div class="card">
                        <div class="body" style="padding-left: 1%;">
                            <form class="m-4" [formGroup]="docForm">
                                <h5 style="color: rgb(10, 25, 109);">Required Filters to Search</h5><br>
                                <div class="row">
                                    <div class=" col-md-2">
                                        <label style="margin-top: 11px;">BANK NAME</label>
                                    </div>
                                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select class="inputTxt" formControlName="bankname" >
                                              <mat-option [value]="'SBI'">
                                                  SBI
                                                </mat-option>
                                                <mat-option [value]="'IOB'">
                                                  IOB
                                                </mat-option>
                                                <mat-option [value]="'HDFC'">
                                                  HDFC
                                                </mat-option>
                                                <mat-option [value]="'INDIAN BANK'">
                                                  INDIAN BANK
                                                </mat-option>
                                                <mat-option [value]="'ICICI'">
                                                  ICICI
                                                </mat-option>
                                          </mat-select>
                                          </mat-form-field>
                                        <!-- <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select formControlName="bankname">
                                                <mat-option *ngFor="let title of banknameList" [value]="title.text">
                                                  {{title.text}}
                                                </mat-option>
                                              </mat-select>
                                        </mat-form-field> -->
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 11px;">LOAN TYPE</label>
                                    </div>
                                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                          <mat-select class="inputTxt" formControlName="type">
                                            <mat-option [value]="'Personal Loan'">
                                              Personal Loan
                                              </mat-option>
                                              <mat-option [value]="'Home Loan'">
                                                Home Loan
                                              </mat-option>
                                              <mat-option [value]="'Education Loan'">
                                                Education Loan
                                              </mat-option>
                                              <mat-option [value]="'Business Loan'">
                                                Business Loan
                                              </mat-option>
                                              <mat-option [value]="'Security Loan'">
                                                Security Loan
                                              </mat-option>
                                              <mat-option [value]="'Property Loan'">
                                                Property Loan
                                              </mat-option>
                                              <mat-option [value]="'Payday Loan'">
                                                Payday Loan
                                              </mat-option>
                                              <mat-option [value]="'Vehicle Loan'">
                                                Vehicle Loan 
                                              </mat-option>
                                        </mat-select>
                                        </mat-form-field>
                                    <!-- <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select formControlName="type">
                                                <mat-option *ngFor="let title of loantypeList" [value]="title.text">
                                                  {{title.text}}
                                                </mat-option>
                                              </mat-select>
                                        </mat-form-field>
                                    </div> -->
                                        </div>
                                        <div class=" col-md-2">
                                            <label style="margin-top: 11px;">CURRENCY</label>
                                        </div>
                                        <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                            <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                                <mat-select formControlName="currencyl" >
                                                  <mat-option [value]="'KSH'">KSH</mat-option>
                                                  <mat-option [value]="'INR'">INR</mat-option>
                                                  <mat-option [value]="'TES'">TES</mat-option>
                                                  </mat-select>
                                                </mat-form-field>
                                            <!-- <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                                <mat-select formControlName="currencyl">
                                                    <mat-option *ngFor="let title of currencyList" [value]="title.text">
                                                      {{title.text}}
                                                    </mat-option>
                                                  </mat-select>
                                            </mat-form-field> -->
                                        </div>
                                </div>
                                <!-- <div class="row"> -->
                                    <!-- <div class=" col-md-2">
                                        <label style="margin-top: 11px;">LOAN-HOLDER NAME</label>
                                    </div>
                                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 ">
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select formControlName="id">
                                                <mat-option *ngFor="let title of loanholderList" [value]="title.id">
                                                  {{title.text}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div> -->
                                    <!-- <div class=" col-md-2">
                                        <label style="margin-top: 11px;">LOAN REFERENCE</label>
                                    </div>
                                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select tabindex="6" formControlName="loanRef" >
                                                <mat-option *ngFor="let title of loanrefList" [value]="title.text">
                                                    {{title.text}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div> -->
                                    <!-- <div class=" col-md-2">
                                        <label style="margin-top: 11px;">BANK IFSC</label>
                                    </div>
                                    <div class="col-xl-2 col-lg-4 col-md-12 col-sm-12 " >
                                        <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                            <mat-select formControlName="ifsccode">
                                                <mat-option *ngFor="let title of bankifscList" [value]="title.text">
                                                  {{title.text}}
                                                </mat-option>
                                              </mat-select>
                                        </mat-form-field>
                                    </div> -->
                                <!-- </div> -->
                                <br>
                                <div class="row" >
                                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-3">
                                      <button (click) = "onSubmit()" class="btn-space" mat-raised-button
                                        color="accent" style="margin-left: 43%;background-color: #34d034;">Submit</button>
                                      <button color="primary" type="button" class="btn-space" (click)="reset()" mat-raised-button>Reset</button>
                                    </div>
                                </div>
                                <hr><br>
                                <!-- <h5 style="color: rgb(10, 25, 109);"><span style="color: red;">*</span></h5><br> -->
                                <mat-accordion>
                                  <mat-expansion-panel (opened)="panelOpenState = true"
                                  (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header>
                                      <mat-panel-title>
                                        <h5 style="color: rgb(10, 25, 109);">Required Columns in Excel Export <span style="color: red;">*</span></h5>
                                      </mat-panel-title>
                                      <mat-panel-description>
                                        Export To Excel {{panelOpenState ? 'open' : 'closed'}}
                                      </mat-panel-description>
                                    </mat-expansion-panel-header>
                                <div class="row">
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN-HOLDER NAME</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                        <mat-checkbox style="margin-top: 6px;margin-left: -50px; " formControlName="nameCheckbox"
                                         ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">EMAIL-ID</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="mailCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN REFERENCE</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="loanRefCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN TYPE</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="typeCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                </div><br>
                                <div class="row">
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN NUMBER</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                        <mat-checkbox style="margin-top: 6px;margin-left: -50px; " formControlName="loannoCheckbox"
                                         ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN AMOUNT</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="loanAmountCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN START DATE</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="loanStartDateCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN END DATE</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="loanDueDateCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                </div><br>
                                <div class="row">
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">CURRENCY</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                        <mat-checkbox style="margin-top: 6px;margin-left: -50px; " formControlName="currencylCheckbox"
                                         ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">EMI AMOUNT</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="amountCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">EMI DATE</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="emiDateCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">RATE OF INTEREST(%)</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="interestRateCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                </div><br>
                                <div class="row">
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">BANK NAME</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                        <mat-checkbox style="margin-top: 6px;margin-left: -50px; " formControlName="banknameCheckbox"
                                         ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">LOAN ACCOUNT No.</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="accountCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                    <div class=" col-md-2">
                                        <label style="margin-top: 9px;">BANK IFSC</label>
                                    </div>
                                    <div class="col-xl-1 col-lg-4 col-md-12 col-sm-12 ">
                                      <mat-checkbox style="margin-top: 6px;margin-left: -50px;" formControlName="ifsccodeCheckBox" 
                                       ngInit="checked=true"></mat-checkbox>
                                    </div>
                                </div><br>
                              </mat-expansion-panel>
                            </mat-accordion>

                                <hr>
                                <br>
                                <div class="row">
                                    <div class=" col-md-6">
                                        <h5 style="color: rgb(10, 25, 109);">Filters based Loan History List</h5>
                                    </div>
                                    <div class=" col-md-6">
                                        <div class="export-button m-l-10" matTooltip="Export To Excel" style="margin-left: 77%;">
                                          <button color="primary" type="button" class="btn-space" (click)="exportExcel()" 
                                          *ngIf="docForm.get('nameCheckbox')?.value || docForm.get('mailCheckBox')?.value || 
                                          docForm.get('loanRefCheckBox')?.value || docForm.get('loanAmountCheckBox')?.value || 
                                          docForm.get('loannoCheckbox')?.value || docForm.get('loanStartDateCheckBox')?.value || 
                                          docForm.get('typeCheckBox')?.value || docForm.get('loanDueDateCheckBox')?.value || 
                                          docForm.get('currencylCheckbox')?.value || docForm.get('amountCheckBox')?.value || 
                                          docForm.get('emiDateCheckBox')?.value || docForm.get('interestRateCheckBox')?.value 
                                          || docForm.get('banknameCheckbox')?.value || docForm.get('accountCheckBox')?.value   
                                          || docForm.get('ifsccodeCheckBox')?.value"
                                          mat-raised-button>Export To Excel</button>
                                        </div>
                                      </div>
                                </div><br>
                            

                                <div class="tableBody">
                                    <div class="table-responsive">
                                        <table class="table table-hover table-striped" style="width: 150%;">
                                            <thead>
                                                <tr>
                                                 <th style="background-color:#607D8B; width: 10%;color:#FFFFFF">LOAN-HOLDER NAME</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">D.O.B</th>
                                                 <th style="background-color:#607D8B; width: 6%;color:#FFFFFF">EMAIL-ID</th>
                                                 <th style="background-color:#607D8B; width: 8%;color:#FFFFFF">LOAN REFERENCE</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">LOAN TYPE</th>
                                                 <th style="background-color:#607D8B; width: 8%;color:#FFFFFF">LOAN NUMBER</th>
                                                 <th style="background-color:#607D8B; width: 8%;color:#FFFFFF">LOAN AMOUNT</th>
                                                 <th style="background-color:#607D8B; width: 8%;color:#FFFFFF">LOAN START DATE</th>
                                                 <th style="background-color:#607D8B; width: 8%;color:#FFFFFF">LOAN END DATE</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">CURRENCY</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">EMI AMOUNT</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">EMI DATE</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">RATE OF INTEREST(%)</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">BANK NAME</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">LOAN ACCOUNT No.</th>
                                                 <th style="background-color:#607D8B; width: 5%;color:#FFFFFF">BANK IFSC</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let data of loanHistoryList | paginate: { itemsPerPage: 5, currentPage: pageChanged }">
                                                  <td>{{data.name}}</td>
                                                  <td>{{data.dob}}</td>
                                                  <td>{{data.mail}}</td>
                                                  <td>{{data.loanRef}}</td>
                                                  <td>{{data.type}}</td>
                                                  <td>{{data.loan}}</td>
                                                  <td>{{data.loanAmount}}</td>
                                                  <td>{{data.loanStartDate}}</td>
                                                  <td>{{data.loanDueDate}}</td>
                                                  <td>{{data.currencyl}}</td>
                                                  <td>{{data.amount}}</td>
                                                  <td>{{data.emiDate}}</td>
                                                  <td>{{data.interestRate}}</td>
                                                  <td>{{data.bankname}}</td>
                                                  <td>{{data.account}}</td>
                                                  <td>{{data.ifsccode}}</td>
                                                </tr>
                                              </tbody>
                                        </table>
                                        <div style="margin-left: 40%;">
                                            <pagination-controls (pageChange)="pageChanged=($event)"></pagination-controls>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>