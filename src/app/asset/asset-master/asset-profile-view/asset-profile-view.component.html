<section class="content">
    <div class="content-block">
        <form class="m-4" [formGroup]="docForm">
        <div class="block-header">
            <!-- breadcrumb -->
            <app-breadcrumb [title]="'Asset Profile'" [items]="['Asset ']" [active_item]="'AssetProfile'">
            </app-breadcrumb>
        </div>
        <!-- Your content goes here  -->
        <div class="row clearfix">
            <div class="col-lg-4 col-md-12">
                <div class="card">

                    <div class="m-b-20">
                        <div class="contact-grid">
                            <div class="profile-header bg-dark">
                                <div class="user-name">{{profileViewDetails?.assetName}}</div>
                                <div class="name-center">{{profileViewDetails?.assetCode}}</div>
                            </div>
                            <div class="col-md-4 sign-img" style="margin-left: 33%;">
                                <img [attr.src]="this.imagePath"  class="user-img" />
                            </div>
                            <p>
                                {{profileViewDetails?.category}}
                                <br />{{profileViewDetails?.status}}
                            </p>
                            <div>
                                <span><i class="material-icons"> location_on</i></span>
                                <span>{{profileViewDetails?.locationName}}</span>
                            </div>
                            <div class="row">
                                <div class="col-4">
                                    <h5>{{profileViewDetails?.purchasePrice}}</h5>
                                    <small>Purchase Value </small>
                                </div>
                                <div class="col-4">
                                    <h5>{{profileViewDetails?.captitalizationPrice}}</h5>
                                    <small>Captitalization Price</small>
                                </div>
                                <div class="col-4">
                                    <h5>{{profileViewDetails?.depreciation}}</h5>
                                    <small>Depreciation</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-12">
                    <div class="card">
                        <div class="header">
                            <h2>Files </h2>
                        </div>
                            <div class="iconCard" style="margin-left: 3%;">
                                <span><i class="far fa-file-alt docIcons"></i>{{profileViewDetails?.uploadFiles?.split('##').pop()}}</span>
                                <a class="downloadView" (click)="viewDocuments(profileViewDetails?.uploadFiles, profileViewDetails?.uploadFiles?.split('##').pop())">
                                  <i class="fas fa-eye" style=" cursor: pointer;color: #3D78BE;"></i>
                                </a>
                              </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-8 col-md-12">
                <div class="card">
                    <mat-tab-group (selectedTabChange)="accurredDepreciationPopUp($event);">
                        <mat-tab>
                            <ng-template mat-tab-label>
                                <mat-icon class="example-tab-icon msr-2">face</mat-icon>
                                About
                            </ng-template>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="project_widget">
                                    <div class="header">
                                        <h2><strong>Asset Info</strong></h2>
                                    </div>
                                    <div class="body">
                                        <div class="row">
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Brand</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.brand}}</p>
                                            </div>
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Model</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.model}}</p>
                                            </div>
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Serial No</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.serialNo}}</p>
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Condition</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.status}}</p>
                                            </div>
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>linked Asset</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.linkedAsset}}</p>
                                            </div>
                                            <div class="col-md-3 col-6 b-r">
                                                <strong>Discription</strong>
                                                <br>
                                                <p class="text-muted">{{profileViewDetails?.description}}</p>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="project_widget">
                                    <div class="header">
                                        <h2><strong>Purchase Info</strong></h2>
                                    </div>
                                    <div class="body">
                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Vendor Name</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.vendor}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>PO Number</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.poNumber}}</p>
                                            </div>

                                        </div>



                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Invoice Date</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.invoiceDate}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Invoice Number</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.invoiceNo}}</p>
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Purchase Price</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.purchasePrice}}</p>
                                            </div>


                                            <!-- <div class="col-md-2 col-4 b-r">
                                                <strong>Invoice Number</strong>

                                            </div> -->

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.selfOrPartner}}</p>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="project_widget">
                                    <div class="header">
                                        <h2><strong>Financial Info</strong></h2>
                                    </div>
                                    <div class="body">
                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Captitalization Price</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.captitalizationPrice}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Captitalization Date</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.captitalizationDate}}</p>
                                            </div>

                                        </div>



                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>End of life</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.endLife}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Scrap Value</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.scrapValue}}</p>
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Depreciation</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.depreciation}}</p>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="project_widget">
                                    <div class="header">
                                        <h2><strong>Alloted Info</strong></h2>
                                    </div>
                                    <div class="body">
                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Department</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.department}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Allotted Upto</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.allottedUpto}}</p>
                                            </div>

                                        </div>



                                        <div class="row">
                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Transferred To</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.transferredTo}}</p>
                                            </div>


                                            <div class="col-md-2 col-4 b-r">
                                                <strong>Remarks</strong>

                                            </div>

                                            <div class="col-md-2 col-4 b-r">
                                                <p class="text-muted">{{profileViewDetails?.remarks}}</p>
                                            </div>


                                        </div>
                                    </div>
                                </div>
                            </div>
                        </mat-tab>

                        <mat-tab label="Accurred Depreciation" style="overflow-x: hidden!important;" >
                            <br>
                            <div class="row" style="overflow-x: hidden!important;">
                                <div class="col-xl-3 col-lg-2 col-md-2 col-sm-12 " >
                                  <label class="lable" style="font-size: 12;margin-left: 4%;">Asset Id :</label>
                              </div> 
                              <div class="col-xl-3 col-lg-4 col-md-12 col-sm-12 " style="margin-left: -7%;">
                                {{auditableAsset.assetid}}
                              </div>
            
                              <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 " >
                                <label class="lable">Acquisition Value :</label>
                              </div>
                      
                              <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 " style=" margin-left: -4%; ">
                              {{auditableAsset.value}}
                              </div>  
                            </div><br>

                            <div class="row">
                                <div class="col-xl-4 col-lg-2 col-md-2 col-sm-12 " >
                                    <label class="lable">Asset Name :</label>
                                </div> 
                                <div class="col-xl-2 col-lg-3 col-md-12 col-sm-12 " style="margin-left: -138px;">
                                  {{auditableAsset.assetname}}
                                </div>
                                <div class="col-xl-3 col-lg-2 col-md-2 col-sm-12 " style="margin-left: 77px;">
                                    <label class="lable">Salvage Value :</label>
                                </div> 
                                <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 " style=" margin-left: -3%;  ">
                                  {{auditableAsset.salvageValue}}
                                </div>
                              </div><br>

                              <div class="row">
                                <div class="col-xl-3 col-lg-2 col-md-2 col-sm-12 " >
                                    <label class="lable">Useful Years :</label>
                                </div> 
                                <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 "  style=" margin-left: -7%;  ">
                                  {{auditableAsset.lifeInYears}}
                                </div>
                                <div class="col-xl-3 col-lg-2 col-md-2 col-sm-12 " >
                                    <label class="lable">Acquisition Date :</label>
                                </div> 
                                <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 " style=" margin-left: -5%;" >
                                  {{auditableAsset.acquisitiondt}}
                                </div>
                              </div><br>

                              <div class="row">
                              <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 ">
                                  <label class="lable" style="margin-left: 73px;">FY :</label>
                              </div> 
          
                              <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12" style="margin-left: -25px;margin-top: -10px;">
                                <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                  <mat-label>Financial Year</mat-label>
                                  <!-- <input matInput formControlName="depreciationMethod" maxlength="4" (change)="financialChange($event.target.value)" (keypress)="keyPressPCB($event)"> -->
                                  <input matInput formControlName="depreciationMethod" maxlength="4">
                                </mat-form-field>
                              </div>
          
                              <div class="col-md-2" style="padding-top: 8px;margin-left: -18px;" >
                                <i class="fa fa-search" aria-hidden="true" (click)="financialChange()"></i>
                              </div>
          
          
                              <!-- <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 " *ngIf="fullLifeFlag">
                                  <label class="lable">FY :</label>
                              </div> 
                              <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12" *ngIf="fullLifeFlag" style="margin-left: -25px;">
                                <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                                  <mat-label>Financial Year</mat-label>
                                  <input matInput formControlName="depreciationMethod" maxlength="4" (change)="financialChange($event.target.value)" (keypress)="keyPressPCB($event)" readonly>
                                </mat-form-field>
                                
                              </div>
                            
                              <div class="col-md-2" style="padding-top: 16px;" *ngIf="fullLifeFlag">
                                <i class="fa fa-search" aria-hidden="true" (click)="financialChange()"></i>
                              </div> -->
                              
                              <div class="col-xl-3 col-lg-3 col-md-2 col-sm-12 " style="margin-left: -89px;" >
                                <label class="lable">Dep Method :</label>
                            </div> 
                            <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 " style=" margin-left: -10%;">
                              {{auditableAsset.depreciationMethod}}
                            </div>
          
                            </div><br>

                            <div class="col-xl-2 col-lg-3 col-md-12 col-sm-12 " style="margin-left: 713px;">
                                <mat-checkbox formControlName="assetType" ngInit="checked=true" (change)="checkFullLife($event)">Show Full Life</mat-checkbox>
                                <!-- <mat-checkbox formControlName="assetType" ngInit="checked=true">Show Full Life</mat-checkbox> -->
                            </div>

                            <div class="container" style="height: 200px ;overflow-y: scroll">
                                <!-- <img src="assets/images/icons/xlsx.png" alt="" style="margin-left:97%"/> -->
                                
                              
                                  <table id="excel-table" class="table table-striped">
                                    <thead>
                                        <tr style="position: sticky;top: 0;">
                                          <th style="background-color:#c1ddf5;">Sl No</th>
                                          <th style="background-color:#c1ddf5;">FY</th>
                                          <th style="background-color:#c1ddf5;text-align: right;">Book Value</th>
                                          <th style="background-color:#c1ddf5;text-align: right;">Depreciation</th>
                                          <th style="background-color:#c1ddf5;text-align: right;">Acc Depreciation</th>
                                          <th style="background-color:#c1ddf5;text-align: right;">Book Value End</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                          <tr *ngFor="let visitReport of financialChangeDetails;">
                                          <!-- <tr> -->
                                            <td>{{visitReport.yearseq}}</td>
                                            <td>{{visitReport.financial_year}}</td>
                                            <td style="text-align: right;">{{visitReport.bookvalue.toFixed(2)}}</td>
                                            <td style="text-align: right;">{{visitReport.depreciation.toFixed(2)}}</td>
                                            <td style="text-align: right;">{{visitReport.accudepreciation.toFixed(2)}}</td>
                                            <td style="text-align: right;">{{visitReport.bookvalueend.toFixed(2)}}</td>
                                          </tr>        
                                    </tbody>
                                  </table>
                              </div><br>

                          </mat-tab>

                          <mat-tab label="Asset Movement History">
                          <br>
                          <div class="row" style="width: 136%;">
                          <!-- <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12">
                            <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                              <mat-label>Item</mat-label>
                              <mat-select   name ="item" formControlName="item">
                                <mat-option *ngFor="let title of itemNameDdList" [value]="title.id">
                                  {{title.text}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div> -->

                          <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12">
                            <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                              <mat-label>Location</mat-label>
                              <mat-select formControlName="location" >
                                <mat-option *ngFor="let title of locationDdList" [value]="title.id">
                                  {{title.text}}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>

                          <!-- <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12">
                            <mat-form-field class="example-full-width form-control-sm" appearance="outline">
                              <mat-label>Stock On</mat-label>
                              <input matInput [matDatepicker]="picker" formControlName="fromDateObj"
                              (dateInput)="$event.value.format('DD/MM/YYYY')" id="fromDate" 
                              (dateChange)="getDateString($event,'fromDate')" >
                              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                              <mat-datepicker #picker></mat-datepicker>
                            </mat-form-field>
                          </div> -->
                        </div>

                        <div class="row">
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12" style="display:flex; align-items: center; justify-content:center;" >
                                <button  class="btn-space" mat-raised-button (click)=" viewReport()"
                                    style=" color: aliceblue; background-color: green;" ><i class="fa fa-search"></i> View Report</button>
                                <button color="warn"  type="button"  (click)="reset()" 
                                    mat-raised-button color="primary" style="background-color: rgb(14, 42, 126);">Reset</button>
                            </div>
                        </div>
                        <br>
                        <br>
     
     <!-- detail_table_starts-->
     <table mat-table #outerSort="matSort" [dataSource]="dataSource" multiTemplateDataRows
          class="mat-elevation-z8" matSort style="width: 100%;">
          
          <ng-container matColumnDef="assetName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>&nbsp;Item Name</th>
              <td mat-cell *matCellDef="let row"> {{row.assetName}}
              </td>
          </ng-container>
          <ng-container matColumnDef="categoryName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Item Description</th>
              <td mat-cell *matCellDef="let row"> {{row.categoryName}}
              </td>
          </ng-container>
          <ng-container matColumnDef="location">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Location</th>
              <td mat-cell *matCellDef="let row"> {{row.location}}
              </td>
          </ng-container>
          <ng-container matColumnDef="quantity">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Quantity</th>
              <td mat-cell *matCellDef="let row"> {{row.quantity}}
              </td>
          </ng-container>

          
          
          <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
          <ng-container matColumnDef="expandedDetail">
              <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                  <div class="example-element-detail" *ngIf="element.subList"
                      [@detailExpand]="isExpanded(element)">
                      <div class="inner-table mat-elevation-z8" *ngIf="isExpanded(element)">
          
                          <table #innerTables mat-table #innerSort="matSort"
                              [dataSource]="element.subList" multiTemplateDataRows matSort>
                             
                              <ng-container matColumnDef="date">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
                                  <td mat-cell *matCellDef="let row"> {{row.date}}
                                  </td>
                              </ng-container>
                              <ng-container matColumnDef="docType">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Doc.Type</th>
                                  <td mat-cell *matCellDef="let row"> {{row.docType}}
                                  </td>
                              </ng-container>
                              <ng-container matColumnDef="docRef">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Doc.Ref</th>
                                  <td mat-cell *matCellDef="let row"> {{row.docRef}}
                                  </td>
                              </ng-container>
                              <ng-container matColumnDef="inQty">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header>In Qty</th>
                                  <td mat-cell *matCellDef="let row"> {{row.inQty}}
                                  </td>
                              </ng-container>
                              <ng-container matColumnDef="outQty">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Out Qty</th>
                                  <td mat-cell *matCellDef="let row"> {{row.outQty}}
                                  </td>
                              </ng-container>
                              <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                              <tr mat-row *matRowDef="let element; columns: innerDisplayedColumns;"></tr>
                           
                          </table>
                      </div>
                  </div>
              </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
          <tr mat-row *matRowDef="let element; columns: columnsToDisplay;"
            [class.example-element-row]="element.subList" [class.example-expanded-row]="isExpanded(element)"
            (click)="toggleRow(element)">
          </tr>
          <tr mat-row *matRowDef="let row1; columns: ['expandedDetail']" class="example-detail-row"></tr>
          </table>
                          </mat-tab>


                    </mat-tab-group>
                </div>
            </div>
        </div>
    </form>
    </div>
</section>